---
title: "P8105 (Data Science I): Homework 3"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)

theme_set(theme_bw())
```

## Problem 1

#### Importing and cleaning BRFSS data 

```{r importing brfss data}
brfss_data <- p8105.datasets::brfss_smart2010 %>% 
  janitor::clean_names()

brfss_data <- brfss_data %>% 
  rename(state = locationabbr, 
         location = locationdesc) %>% 
  filter(topic == "Overall Health") %>% 
  mutate(response = as.factor(response))
```

#### Questions and plots

```{r calculating 7 obs in 2002}
brfss_data %>% 
  filter(year == 2002) %>% 
  distinct(state, location) %>% 
  count(state) %>% 
  filter(n == 7) 
```

> insert answers to data description problems 

```{r creating spaghetti plot, fig.width = 9, fig.height = 7}
brfss_data %>% 
  group_by(state, year) %>% 
  summarize(n_obs = n()) %>% 
  ggplot(aes(x = year, y = n_obs)) + 
    geom_line(aes(color = state)) + 
    viridis::scale_color_viridis(
      name = "", 
      discrete = TRUE) +
    labs(x = "Year", 
         y = "Number of observations") + 
    theme(legend.position = "bottom", 
          legend.direction = "horizontal") + 
    guides(color = guide_legend(ncol = 14))
```

## Problem 2

```{r}
insta_data <- p8105.datasets::instacart %>% 
  janitor::clean_names()
```


## Problem 3