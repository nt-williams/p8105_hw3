P8105 (Data Science I): Homework 3
================

Problem 1
---------

#### Importing and cleaning BRFSS data

``` r
brfss_data <- p8105.datasets::brfss_smart2010 %>% 
  janitor::clean_names()

brfss_data <- brfss_data %>% 
  rename(state = locationabbr, 
         location = locationdesc) %>% 
  filter(topic == "Overall Health") %>% 
  mutate(response = as.factor(response))
```

#### Questions and plots

``` r
brfss_data %>% 
  filter(year == 2002) %>% 
  distinct(state, location) %>% 
  count(state) %>% 
  filter(n == 7) 
```

    ## # A tibble: 3 x 2
    ##   state     n
    ##   <chr> <int>
    ## 1 CT        7
    ## 2 FL        7
    ## 3 NC        7

> insert answers to data description problems

``` r
brfss_data %>% 
  group_by(state, year) %>% 
  summarize(n_obs = n()) %>% 
  ggplot(aes(x = year, y = n_obs)) + 
    geom_line(aes(color = state)) + 
    viridis::scale_color_viridis(
      name = "", 
      discrete = TRUE) +
    labs(x = "Year", 
         y = "Number of observations") + 
    theme(legend.position = "bottom", 
          legend.direction = "horizontal") + 
    guides(color = guide_legend(ncol = 17))
```

![](p8105_hw3_ntw2117_files/figure-markdown_github/creating%20spaghetti%20plot-1.png)

``` r
library(patchwork)

avg_response_year_state <- 
  brfss_data %>%
  mutate(year = as.factor(year)) %>% 
  group_by(year, state, response) %>%
  summarize(avg_response = mean(data_value))

poor_dist <- avg_response_year_state %>%
  filter(response == "Poor") %>%
  ggplot(aes(x = avg_response, fill = year)) +
    geom_density(alpha = 0.5) + 
    geom_text(x = 0, y = 0.40, 
              label = "Poor", 
              size = 5) + 
    scale_x_continuous(limits = c(0, 45), 
                       breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45)) + 
    theme(axis.text.x = element_blank(), 
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank()) + 
    labs(y = "", x = "") +
    scale_fill_discrete(guide = FALSE) 

fair_dist <- avg_response_year_state %>%
  filter(response == "Fair") %>%
  ggplot(aes(x = avg_response, fill = year)) +
    geom_density(alpha = 0.5) +
    geom_text(x = 0, y = 0.15, 
              label = "Fair",
              size = 5) + 
    scale_x_continuous(limits = c(0, 45), 
                       breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45)) + 
    theme(axis.text.x = element_blank(), 
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank()) + 
    labs(y = "", x = "") +
    scale_fill_discrete(guide = FALSE) +
    viridis::scale_color_viridis(discrete = TRUE)

good_dist <- avg_response_year_state %>%
  filter(response == "Good") %>%
  ggplot(aes(x = avg_response, fill = year)) +
    geom_density(alpha = 0.5) +
    geom_text(x = 0, y = 0.15, 
              label = "Good", 
              size = 5) + 
    scale_x_continuous(limits = c(0, 45), 
                       breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45)) + 
    theme(axis.text.x = element_blank(), 
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank()) + 
    labs(y = "", x = "") +
    scale_fill_discrete(guide = FALSE)

v_good_dist <- avg_response_year_state %>%
  filter(response == "Very good") %>%
  ggplot(aes(x = avg_response, fill = year)) +
    geom_density(alpha = 0.5) +
    geom_text(x = 1, y = 0.125, 
              label = "Very good", 
              size = 5) + 
    scale_x_continuous(limits = c(0, 45), 
                       breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45)) + 
    theme(axis.text.x = element_blank(), 
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank()) + 
    labs(y = "", x = "") +
    scale_fill_discrete(guide = FALSE)

excel_dist <- avg_response_year_state %>%
  filter(response == "Excellent") %>%
  ggplot(aes(x = avg_response, fill = year)) +
    geom_density(alpha = 0.5) +
    geom_text(x = 1, y = 0.15, 
              label = "Excellent", 
              size = 5) + 
    scale_x_continuous(limits = c(0, 45), 
                       breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40, 45)) + 
    labs(y = "", x = "Response percentage") +
    scale_fill_discrete(name = "Year") +
    theme(legend.position = "bottom",
          legend.direction = "horizontal", 
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank()) + 
    guides(fill = guide_legend(ncol = 10))

poor_dist / fair_dist / good_dist / v_good_dist / excel_dist
```

![](p8105_hw3_ntw2117_files/figure-markdown_github/average%20proportion,%20response%20category%20across%20location%20by%20state-1.png)

Problem 2
---------

``` r
insta_data <- p8105.datasets::instacart %>% 
  janitor::clean_names()
```

Problem 3
---------
